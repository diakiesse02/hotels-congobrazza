<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Admin - Liste des Hôtels</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    h2 { color: #333; }
    .hotel { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; }
    .images img { width: 100px; margin-right: 5px; }
    #logout { margin-bottom: 20px; }
  </style>
</head>
<body>

  <h2>Liste des Hôtels (Admin)</h2>

  <div id="auth">
    <button id="login">Se connecter avec Google</button>
    <button id="logout" style="display:none;">Se déconnecter</button>
    <p id="userEmail"></p>
  </div>

  <div id="hotelList"></div>

  <script type="module">
    import {
      initializeApp
    } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
    import {
      getFirestore, collection, getDocs
    } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-firestore.js";
    import {
      getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut
    } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js";

    // 🔐 Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyBo9JsPem6NqNWL1DHiPQFck5PLJvADRUI",
      authDomain: "congo-reservation.firebaseapp.com",
      projectId: "congo-reservation",
      storageBucket: "congo-reservation.appspot.com",
      messagingSenderId: "54528039217",
      appId: "1:54528039217:web:8158927e3b22c8a24a3810",
      measurementId: "G-E4MZGSVB4H"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    const loginBtn = document.getElementById("login");
    const logoutBtn = document.getElementById("logout");
    const hotelList = document.getElementById("hotelList");
    const userEmail = document.getElementById("userEmail");

    loginBtn.onclick = () => signInWithPopup(auth, provider);
    logoutBtn.onclick = () => signOut(auth);

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        userEmail.textContent = "Connecté : " + user.email;
        loginBtn.style.display = "none";
        logoutBtn.style.display = "inline";

        const querySnapshot = await getDocs(collection(db, "hotels"));
        querySnapshot.forEach((doc) => {
          const data = doc.data();
          const div = document.createElement("div");
          div.className = "hotel";
          div.innerHTML = `
            <h3>${data.nom}</h3>
            <p><strong>Adresse :</strong> ${data.adresse}</p>
            <p><strong>Téléphone :</strong> ${data.telephone}</p>
            ${data.site ? `<p><strong>Site Web :</strong> <a href="${data.site}" target="_blank">${data.site}</a></p>` : ''}
            <p><strong>Services :</strong> ${data.services?.join(", ")}</p>
            <p><strong>Auteur :</strong> ${data.auteur || 'Anonyme'}</p>
            <div class="images">
              ${(data.images || []).map(url => `<img src="${url}" alt="Image hôtel" />`).join("")}
            </div>
          `;
          hotelList.appendChild(div);
        });

      } else {
        hotelList.innerHTML = "<p>Vous devez être connecté pour voir les hôtels.</p>";
        loginBtn.style.display = "inline";
        logoutBtn.style.display = "none";
        userEmail.textContent = "";
      }
    });
  </script>

</body>
</html>
